---
import type { BlogData } from "@schemas/blog";
import type { MarkdownHeading } from "astro";

import SharedLayout from "./SharedLayout.astro";

export type Props = BlogData & { headings: MarkdownHeading[] };

const page = Astro.props;
---

<SharedLayout meta={page.meta}>
  <article
    class="prose prose-a:underline-offset-2 prose-pre:border prose-pre:border-slate-500"
  >
    <h1 class="mb-0">{page.heading}</h1>
    <time class="text-gray-500" datetime={page.date.toISOString()}>
      {
        page.date.toLocaleDateString("en-US", {
          year: "numeric",
          month: "long",
          day: "numeric",
        })
      }
    </time>
    {
      page.toc && (
        <div class="not-prose pt-4">
          <div class="rounded-sm border border-gray-500 bg-white p-4">
            <h2 class="text-2xl font-semibold text-gray-800">Contents</h2>
            <ol class="ml-4 list-outside list-decimal p-1">
              {page.headings.map((heading) => (
                <li>
                  <a
                    href={`#${heading.slug}`}
                    class="font-semibold text-gray-800 underline underline-offset-2"
                  >
                    {heading.text}
                  </a>
                </li>
              ))}
            </ol>
          </div>
        </div>
      )
    }
    <slot />
  </article>
</SharedLayout>
